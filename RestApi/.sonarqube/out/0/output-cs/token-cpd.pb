ç
^C:\Users\2048766\source\angular-websites\RestApi\RestApi\Controllers\AuthenticateController.cs
	namespace 	
RestApi
 
. 
Controllers 
{ 
[ 
Route 

(
 
$str 
) 
] 
[ 
ApiController 
] 
public		 

class		 "
AuthenticateController		 '
:		( )
ControllerBase		* 8
{

 
private 
readonly #
IJwtAuthenticateManager 0
manager1 8
;8 9
public "
AuthenticateController %
(% &#
IJwtAuthenticateManager& ="
jwtAuthenticateManager> T
)T U
{ 	
manager 
= "
jwtAuthenticateManager ,
;, -
} 	
[ 	
HttpPost	 
( 
$str  
)  !
]! "
public 
IActionResult 
Authenticate )
() *
[* +
FromBody+ 3
]3 4
UserCred5 =
userCred> F
)F G
{ 	
var 
response 
= 
manager "
." #
Authenticate# /
(/ 0
userCred0 8
)8 9
;9 :
if 
( 
response 
== 
null  
)  !
return 

BadRequest !
(! "
new" %
{& '
message( /
=0 1
$str2 p
}q r
)r s
;s t
return 
Ok 
( 
response 
) 
;  
} 	
} 
} ı
YC:\Users\2048766\source\angular-websites\RestApi\RestApi\Controllers\ProfileController.cs
	namespace 	
RestApi
 
. 
Controllers 
{ 
[ 
Route 

(
 
$str 
) 
] 
[ 
ApiController 
] 
[		 
	Authorize		 
]		 
public

 

class

 
ProfileController

 "
:

# $
ControllerBase

% 3
{ 
private 
readonly 
IUserService %
service& -
;- .
public 
ProfileController  
(  !
IUserService! -
userService. 9
)9 :
{ 	
service 
= 
userService !
;! "
} 	
[ 	
HttpGet	 
( 
$str $
)$ %
]% &
public 
IActionResult 
GetUser $
($ %
string% +
loginId, 3
)3 4
{ 	
var 
user 
= 
service 
. 
GetUsers '
(' (
)( )
.) *
FirstOrDefault* 8
(8 9
x9 :
=>; =
x> ?
.? @
LoginId@ G
.G H
EqualsH N
(N O
loginIdO V
)V W
)W X
;X Y
return 
Ok 
( 
user 
) 
; 
} 	
} 
} ˇU
VC:\Users\2048766\source\angular-websites\RestApi\RestApi\Controllers\UserController.cs
	namespace 	
RestApi
 
. 
Controllers 
{ 
[ 
Route 

(
 
$str 
) 
] 
[		 
ApiController		 
]		 
[

 
	Authorize

 
]

 
public 

class 
UserController 
:  !
ControllerBase" 0
{ 
private 
readonly 
IUserService %
service& -
;- .
private 
ILogger 
< 
UserController &
>& '
logger( .
;. /
public 
UserController 
( 
IUserService *
userService+ 6
,6 7
ILogger8 ?
<? @
UserController@ N
>N O
loggerP V
)V W
{ 	
service 
= 
userService !
;! "
this 
. 
logger 
= 
logger  
;  !
} 	
[ 	
AllowAnonymous	 
] 
[ 	
HttpPost	 
( 
$str 
) 
] 
public 
IActionResult 
Add  
(  !
[! "
FromBody" *
]* +
User, 0
user1 5
)5 6
{ 	
var 
sameLoginIdCount  
=! "
service# *
.* +
GetUsers+ 3
(3 4
)4 5
.5 6
Where6 ;
(; <
x< =
=>> @
xA B
.B C
LoginIdC J
.J K
EqualsK Q
(Q R
userR V
.V W
LoginIdW ^
)^ _
)_ `
.` a
ToLista g
(g h
)h i
.i j
Countj o
(o p
)p q
;q r
if 
( 
sameLoginIdCount  
>! "
$num# $
)$ %
return 

BadRequest !
(! "
new" %
{& '
message( /
=0 1
$str	2 Ö
}
Ü á
)
á à
;
à â
var 
sameUserEmailCount "
=# $
service% ,
., -
GetUsers- 5
(5 6
)6 7
.7 8
Where8 =
(= >
x> ?
=>@ B
xC D
.D E
EmailE J
.J K
EqualsK Q
(Q R
userR V
.V W
EmailW \
)\ ]
)] ^
.^ _
ToList_ e
(e f
)f g
.g h
Counth m
(m n
)n o
;o p
if 
( 
sameUserEmailCount "
># $
$num% &
)& '
return 

BadRequest !
(! "
new" %
{& '
message( /
=0 1
$str	2 Ç
}
É Ñ
)
Ñ Ö
;
Ö Ü
user!! 
.!! 
Id!! 
=!! 
null!! 
;!! 
user"" 
."" 
DateTime"" 
="" 
DateTime"" $
.""$ %
Now""% (
;""( )
service## 
.## 
Add## 
(## 
user## 
)## 
;## 
logger%% 
.%% 
LogInformation%% !
(%%! "
$str%%" V
)%%V W
;%%W X
return'' 
Ok'' 
('' 
new'' 
{'' 
message'' #
=''$ %
$str''& Z
}''[ \
)''\ ]
;''] ^
}(( 	
[** 	

HttpDelete**	 
(** 
$str** 
)**  
]**  !
public++ 
IActionResult++ 
	DeleteAll++ &
(++& '
)++' (
{,, 	
service-- 
.-- 
	DeleteAll-- 
(-- 
)-- 
;--  
logger// 
.// 
LogInformation// !
(//! "
$str//" N
)//N O
;//O P
return00 
Ok00 
(00 
new00 
{00 
message00 #
=00$ %
$str00& R
}00S T
)00T U
;00U V
}11 	
[33 	

HttpDelete33	 
(33 
$str33 !
)33! "
]33" #
public44 
IActionResult44 
Delete44 #
(44# $
string44$ *
id44+ -
)44- .
{55 	
service66 
.66 

DeleteById66 
(66 
id66 !
)66! "
;66" #
logger88 
.88 
LogInformation88 !
(88! "
$str88" Z
)88Z [
;88[ \
return99 
Ok99 
(99 
new99 
{99 
message99 #
=99$ %
$str99& ^
}99_ `
)99` a
;99a b
}:: 	
[<< 	
HttpGet<<	 
(<< 
$str<< 
)<<  
]<<  !
public== 
IActionResult== 
GetById== $
(==$ %
string==% +
id==, .
)==. /
{>> 	
logger?? 
.?? 

LogWarning?? 
(?? 
$str?? X
)??X Y
;??Y Z
return@@ 
Ok@@ 
(@@ 
service@@ 
.@@ 
GetById@@ %
(@@% &
id@@& (
)@@( )
)@@) *
;@@* +
}AA 	
[CC 	
HttpGetCC	 
(CC 
$strCC 
)CC 
]CC 
publicDD 
IActionResultDD 
GetDD  
(DD  !
)DD! "
{EE 	
loggerFF 
.FF 

LogWarningFF 
(FF 
$strFF a
)FFa b
;FFb c
returnGG 
OkGG 
(GG 
serviceGG 
.GG 
GetUsersGG &
(GG& '
)GG' (
)GG( )
;GG) *
}HH 	
[JJ 	
HttpPutJJ	 
(JJ 
$strJJ 
)JJ 
]JJ 
publicKK 
IActionResultKK 
UpdateKK #
(KK# $
[KK$ %
FromBodyKK% -
]KK- .
UserKK/ 3
userKK4 8
)KK8 9
{LL 	
varMM 
sameEmailIdCountMM  
=MM! "
serviceMM# *
.MM* +
GetUsersMM+ 3
(MM3 4
)MM4 5
.MM5 6
WhereMM6 ;
(MM; <
xMM< =
=>MM> @
xMMA B
.MMB C
EmailMMC H
.MMH I
EqualsMMI O
(MMO P
userMMP T
.MMT U
EmailMMU Z
)MMZ [
)MM[ \
.MM\ ]
CountMM] b
(MMb c
)MMc d
;MMd e
ifOO 
(OO 
sameEmailIdCountOO  
>OO! "
$numOO# $
)OO$ %
{PP 
ifQQ 
(QQ 
sameEmailIdCountQQ $
==QQ% '
$numQQ( )
)QQ) *
{RR 
varSS 
tempSS 
=SS 
serviceSS &
.SS& '
GetUsersSS' /
(SS/ 0
)SS0 1
.SS1 2
FirstOrDefaultSS2 @
(SS@ A
xSSA B
=>SSC E
xSSF G
.SSG H
EmailSSH M
.SSM N
EqualsSSN T
(SST U
userSSU Y
.SSY Z
EmailSSZ _
)SS_ `
)SS` a
;SSa b
ifTT 
(TT 
tempTT 
.TT 
IdTT 
!=TT  "
userTT# '
.TT' (
IdTT( *
)TT* +
returnUU 

BadRequestUU )
(UU) *
newUU* -
{UU. /
messageUU0 7
=UU8 9
$str	UU: Å
}
UUÇ É
)
UUÉ Ñ
;
UUÑ Ö
elseVV 
{WW 
serviceXX 
.XX  
UpdateXX  &
(XX& '
userXX' +
)XX+ ,
;XX, -
loggerZZ 
.ZZ 
LogInformationZZ -
(ZZ- .
$strZZ. ]
)ZZ] ^
;ZZ^ _
return[[ 
Ok[[ !
([[! "
new[[" %
{[[& '
message[[( /
=[[0 1
$str[[2 a
}[[b c
)[[c d
;[[d e
}\\ 
}]] 
return__ 

BadRequest__ !
(__! "
new__" %
{__& '
message__( /
=__0 1
$str__2 y
}__z {
)__{ |
;__| }
}`` 
varbb 
sameLoginIdCountbb  
=bb! "
servicebb# *
.bb* +
GetUsersbb+ 3
(bb3 4
)bb4 5
.bb5 6
Wherebb6 ;
(bb; <
xbb< =
=>bb> @
xbbA B
.bbB C
LoginIdbbC J
.bbJ K
EqualsbbK Q
(bbQ R
userbbR V
.bbV W
LoginIdbbW ^
)bb^ _
)bb_ `
.bb` a
Countbba f
(bbf g
)bbg h
;bbh i
ifee 
(ee 
sameLoginIdCountee  
>ee! "
$numee# $
)ee$ %
{ff 
ifgg 
(gg 
sameLoginIdCountgg $
!=gg% '
$numgg( )
)gg) *
{hh 
returnii 

BadRequestii %
(ii% &
newii& )
{ii* +
messageii, 3
=ii4 5
$str	ii6 Ä
}
iiÅ Ç
)
iiÇ É
;
iiÉ Ñ
}jj 
elsekk 
{ll 
servicemm 
.mm 
Updatemm "
(mm" #
usermm# '
)mm' (
;mm( )
loggeroo 
.oo 
LogInformationoo )
(oo) *
$stroo* Y
)ooY Z
;ooZ [
returnpp 
Okpp 
(pp 
newpp !
{pp" #
messagepp$ +
=pp, -
$strpp. ]
}pp^ _
)pp_ `
;pp` a
}qq 
returnrr 

BadRequestrr !
(rr! "
newrr" %
{rr& '
messagerr( /
=rr0 1
$strrr2 |
}rr} ~
)rr~ 
;	rr Ä
}ss 
servicevv 
.vv 
Updatevv 
(vv 
uservv 
)vv  
;vv  !
loggerxx 
.xx 
LogInformationxx !
(xx! "
$strxx" Q
)xxQ R
;xxR S
returnyy 
Okyy 
(yy 
newyy 
{yy 
messageyy #
=yy$ %
$stryy& U
}yyV W
)yyW X
;yyX Y
}zz 	
}{{ 
}|| ê
\C:\Users\2048766\source\angular-websites\RestApi\RestApi\Controllers\UserSearchController.cs
	namespace 	
RestApi
 
. 
Controllers 
{ 
[ 
Route 

(
 
$str 
) 
] 
[ 
ApiController 
] 
[		 
	Authorize		 
]		 
public

 

class

  
UserSearchController

 %
:

& '
ControllerBase

( 6
{ 
private 
readonly 
IUserService %
service& -
;- .
public  
UserSearchController #
(# $
IUserService$ 0
userService1 <
)< =
{ 	
service 
= 
userService !
;! "
} 	
[ 	
HttpGet	 
( 
$str $
)$ %
]% &
public 
IActionResult 

SearchUser '
(' (
string( .
word/ 3
)3 4
{ 	
var 
users 
= 
service 
.  
GetUsers  (
(( )
)) *
.* +
Where+ 0
(0 1
x1 2
=>3 5
x 
. 
	FirstName 
. 
ToLower #
(# $
)$ %
.% &
Contains& .
(. /
word/ 3
.3 4
ToLower4 ;
(; <
)< =
)= >
||? A
x 
. 
LastName 
. 
ToLower "
(" #
)# $
.$ %
Contains% -
(- .
word. 2
.2 3
ToLower3 :
(: ;
); <
)< =
||> @
x 
. 
Email 
. 
ToLower 
(  
)  !
.! "
Contains" *
(* +
word+ /
./ 0
ToLower0 7
(7 8
)8 9
)9 :
||; =
x 
. 
LoginId 
. 
ToLower !
(! "
)" #
.# $
Contains$ ,
(, -
word- 1
.1 2
ToLower2 9
(9 :
): ;
); <
)< =
.= >
ToList> D
(D E
)E F
;F G
return 
Ok 
( 
users 
) 
; 
} 	
} 
} ﬂ
[C:\Users\2048766\source\angular-websites\RestApi\RestApi\Helpers\IJwtAuthenticateManager.cs
	namespace 	
RestApi
 
. 
Helpers 
{ 
public 

	interface #
IJwtAuthenticateManager ,
{ 
public 
Response 
? 
Authenticate %
(% &
UserCred& .
userCred/ 7
)7 8
;8 9
} 
}		 ≥#
ZC:\Users\2048766\source\angular-websites\RestApi\RestApi\Helpers\JwtAuthenticateManager.cs
	namespace 	
RestApi
 
. 
Helpers 
{		 
public

 

class

 "
JwtAuthenticateManager

 '
:

( )#
IJwtAuthenticateManager

* A
{ 
private 
readonly 
IUserService %
service& -
;- .
private 
readonly 
IConfiguration '
configuration( 5
;5 6
public "
JwtAuthenticateManager %
(% &
IUserService& 2
userService3 >
,> ?
IConfiguration@ N
configurationO \
)\ ]
{ 	
service 
= 
userService !
;! "
this 
. 
configuration 
=  
configuration! .
;. /
} 	
public 
Response 
? 
Authenticate %
(% &
UserCred& .
userCred/ 7
)7 8
{ 	
var 
user 
= 
service 
. 
GetUsers '
(' (
)( )
.) *
FirstOrDefault* 8
(8 9
x9 :
=>; =
x> ?
.? @
LoginId@ G
.G H
EqualsH N
(N O
userCredO W
.W X
LoginIdX _
)_ `
)` a
;a b
if 
( 
user 
== 
null 
) 
return $
null% )
;) *
if 
( 
! 
user 
. 
Password 
. 
Equals %
(% &
userCred& .
.. /
Password/ 7
)7 8
)8 9
return: @
nullA E
;E F#
SecurityTokenDescriptor ##
securityTokenDescriptor$ ;
=< =
new> A#
SecurityTokenDescriptorB Y
{ 
Subject 
= 
new 
ClaimsIdentity ,
(, -
new- 0
Claim1 6
[6 7
]7 8
{ 
new 
Claim 
( 

ClaimTypes (
.( )
Name) -
,- .
userCred/ 7
.7 8
LoginId8 ?
)? @
,@ A
new   
Claim   
(   

ClaimTypes   (
.  ( )
Role  ) -
,  - .
$str  / 5
)  5 6
}!! 
)!! 
,!! 
Expires"" 
="" 
DateTime"" "
.""" #
Now""# &
.""& '

AddMinutes""' 1
(""1 2
$num""2 4
)""4 5
,""5 6
SigningCredentials## "
=### $
new##% (
SigningCredentials##) ;
(##; <
new##< ? 
SymmetricSecurityKey##@ T
(##T U
Encoding##U ]
.##] ^
ASCII##^ c
.##c d
GetBytes##d l
(##l m
configuration##m z
[##z {
$str	##{ Ü
]
##Ü á
)
##á à
)
##à â
,
##â ä 
SecurityAlgorithms
##ã ù
.
##ù û!
HmacSha256Signature
##û ±
)
##± ≤
}$$ 
;$$ #
JwtSecurityTokenHandler&& ##
jwtSecurityTokenHandler&&$ ;
=&&< =
new&&> A#
JwtSecurityTokenHandler&&B Y
(&&Y Z
)&&Z [
;&&[ \
var'' 
token'' 
='' #
jwtSecurityTokenHandler'' /
.''/ 0
CreateToken''0 ;
(''; <#
securityTokenDescriptor''< S
)''S T
;''T U
return)) 
new)) 
Response)) 
{** 
LoginId++ 
=++ 
user++ 
.++ 
LoginId++ &
,++& '
Token,, 
=,, #
jwtSecurityTokenHandler,, /
.,,/ 0

WriteToken,,0 :
(,,: ;
token,,; @
),,@ A
,,,A B
	ValidFrom-- 
=-- 
token-- !
.--! "
	ValidFrom--" +
,--+ ,
ValidTo.. 
=.. 
token.. 
...  
ValidTo..  '
}// 
;// 
}00 	
}11 
}22 ù
KC:\Users\2048766\source\angular-websites\RestApi\RestApi\Models\Response.cs
	namespace 	
RestApi
 
. 
Models 
{ 
public 

class 
Response 
{ 
public 
string 
? 
LoginId 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
? 
Token 
{ 
get "
;" #
set$ '
;' (
}) *
public		 
DateTime		 
	ValidFrom		 !
{		" #
get		$ '
;		' (
set		) ,
;		, -
}		. /
public

 
DateTime

 
ValidTo

 
{

  !
get

" %
;

% &
set

' *
;

* +
}

, -
} 
} ⁄
GC:\Users\2048766\source\angular-websites\RestApi\RestApi\Models\User.cs
	namespace 	
RestApi
 
. 
Models 
{ 
[ #
BsonIgnoreExtraElements 
] 
public 

class 
User 
{ 
[		 	
BsonId			 
]		 
[

 	
BsonRepresentation

	 
(

 
BsonType

 $
.

$ %
ObjectId

% -
)

- .
]

. /
public 
string 
? 
Id 
{ 
get 
;  
set! $
;$ %
}& '
public 
string 
? 
	FirstName  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
? 
LastName 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
? 
Email 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
? 
LoginId 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
? 
Password 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
? 
ContactNumber $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
DateTime 
DateTime  
{! "
get# &
;& '
set( +
;+ ,
}- .
} 
} ‰
KC:\Users\2048766\source\angular-websites\RestApi\RestApi\Models\UserCred.cs
	namespace 	
RestApi
 
. 
Models 
{ 
public 

class 
UserCred 
{ 
public 
string 
? 
LoginId 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
? 
Password 
{  !
get" %
;% &
set' *
;* +
}, -
} 
}  c
CC:\Users\2048766\source\angular-websites\RestApi\RestApi\Program.cs
var 
builder 
= 
WebApplication 
. 
CreateBuilder *
(* +
args+ /
)/ 0
.0 1
AddHealthActuator1 B
(B C
)C D
.D E
AddInfoActuatorE T
(T U
)U V
.V W
AddLoggersActuatorW i
(i j
)j k
;k l
ConfigureLogs 
( 
) 
; 
builder 
. 
Host 
. 

UseSerilog 
( 
) 
; 
builder 
. 
Services 
. 
AddControllers 
(  
)  !
;! "
builder 
. 
Services 
. #
AddEndpointsApiExplorer (
(( )
)) *
;* +
builder 
. 
Services 
. 
AddSwaggerGen 
( 
x  
=>! #
{ 
x 
. !
AddSecurityDefinition 
( 
$str $
,$ %
new& )!
OpenApiSecurityScheme* ?
{ 
Name 
= 
$str 
, 
Description 
= 
$str ,
,, -
BearerFormat 
= 
$str 
, 
Scheme   
=   
$str   
,   
In!! 

=!! 
ParameterLocation!! 
.!! 
Header!! %
,!!% &
Type"" 
="" 
SecuritySchemeType"" !
.""! "
ApiKey""" (
}## 
)## 
;## 
x$$ 
.$$ "
AddSecurityRequirement$$ 
($$ 
new$$  &
OpenApiSecurityRequirement$$! ;
{%% 
{&& 	
new'' !
OpenApiSecurityScheme'' %
{(( 
	Reference)) 
=)) 
new)) 
OpenApiReference))  0
{** 
Id++ 
=++ 
$str++ !
,++! "
Type,, 
=,, 
ReferenceType,, (
.,,( )
SecurityScheme,,) 7
}-- 
}.. 
,.. 
new00 
List00 
<00 
string00 
>00 
(00 
)00 
}11 	
}22 
)22 
;22 
}33 
)33 
;33 
builder55 
.55 
Services55 
.55 
AddTransient55 
<55 
IUserService55 *
,55* +
UserService55, 7
>557 8
(558 9
)559 :
;55: ;
builder66 
.66 
Services66 
.66 
AddTransient66 
<66 #
IJwtAuthenticateManager66 5
,665 6"
JwtAuthenticateManager667 M
>66M N
(66N O
)66O P
;66P Q
builder88 
.88 
Services88 
.88 
AddCors88 
(88 
x88 
=>88 
x88 
.88  
AddDefaultPolicy88  0
(880 1
sam881 4
=>885 7
sam888 ;
.88; <
AllowAnyOrigin88< J
(88J K
)88K L
.88L M
AllowAnyHeader88M [
(88[ \
)88\ ]
.88] ^
AllowAnyMethod88^ l
(88l m
)88m n
)88n o
)88o p
;88p q
builder:: 
.:: 
Services:: 
.:: 
AddAuthentication:: "
(::" #
x::# $
=>::% '
{;; 
x<< 
.<< 
DefaultScheme<< 
=<< 
JwtBearerDefaults<< '
.<<' ( 
AuthenticationScheme<<( <
;<<< =
x== 
.== %
DefaultAuthenticateScheme== 
===  !
JwtBearerDefaults==" 3
.==3 4 
AuthenticationScheme==4 H
;==H I
x>> 
.>> "
DefaultChallengeScheme>> 
=>> 
JwtBearerDefaults>> 0
.>>0 1 
AuthenticationScheme>>1 E
;>>E F
}?? 
)?? 
.?? 
AddJwtBearer?? 
(?? 
x?? 
=>?? 
{@@ 
xAA 
.AA  
RequireHttpsMetadataAA 
=AA 
falseAA "
;AA" #
xBB 
.BB 
	SaveTokenBB 
=BB 
trueBB 
;BB 
xCC 
.CC %
TokenValidationParametersCC 
=CC  !
newCC" %%
TokenValidationParametersCC& ?
{DD 
ValidateAudienceEE 
=EE 
falseEE  
,EE  !
ValidateIssuerFF 
=FF 
falseFF 
,FF $
ValidateIssuerSigningKeyGG  
=GG! "
trueGG# '
,GG' (
IssuerSigningKeyHH 
=HH 
newHH  
SymmetricSecurityKeyHH 3
(HH3 4
EncodingHH4 <
.HH< =
ASCIIHH= B
.HHB C
GetBytesHHC K
(HHK L
builderHHL S
.HHS T
ConfigurationHHT a
[HHa b
$strHHb m
]HHm n
)HHn o
)HHo p
}II 
;II 
}JJ 
)JJ 
;JJ 
builderLL 
.LL 
ServicesLL 
.LL #
AddOpenTelemetryTracingLL (
(LL( )
xLL) *
=>LL+ -
{MM 
xNN 
.NN 
SetResourceBuilderNN 
(NN 
ResourceBuilderNN (
.NN( )
CreateDefaultNN) 6
(NN6 7
)NN7 8
.NN8 9

AddServiceNN9 C
(NNC D
$strNND M
)NNM N
)NNN O
;NNO P
xOO 
.OO 
	AddSourceOO 
(OO 
$strOO $
)OO$ %
;OO% &
xPP 
.PP (
AddAspNetCoreInstrumentationPP "
(PP" #
samPP# &
=>PP' )
samPP* -
.PP- .
FilterPP. 4
=PP5 6
httpContextPP7 B
=>PPC E
!PPF G
httpContextPPG R
.PPR S
RequestPPS Z
.PPZ [
PathPP[ _
.PP_ `
ValuePP` e
?PPe f
.PPf g
ContainsPPg o
(PPo p
$str	PPp õ
)
PPõ ú
??
PPù ü
true
PP† §
)
PP§ •
;
PP• ¶
xQQ 
.QQ (
AddHttpClientInstrumentationQQ "
(QQ" #
samQQ# &
=>QQ' )
samQQ* -
.QQ- .
EnrichQQ. 4
=QQ5 6
(QQ7 8
activityQQ8 @
,QQ@ A
	eventNameQQB K
,QQK L
	rawObjectQQM V
)QQV W
=>QQX Z
{RR 
ifSS 

(SS 
	eventNameSS 
==SS 
$strSS *
&&SS+ -
	rawObjectSS. 7
isSS8 :
HttpRequestMessageSS; M
requestSSN U
&&SSV X
requestSSY `
.SS` a
MethodSSa g
==SSh j

HttpMethodSSk u
.SSu v
GetSSv y
)SSy z
activityTT 
.TT 
SetTagTT 
(TT 
$strTT %
,TT% &
$strTT' b
)TTb c
;TTc d
}UU 
)UU 
;UU 
xVV 
.VV 1
%AddEntityFrameworkCoreInstrumentationVV +
(VV+ ,
samVV, /
=>VV0 2
{WW 
samXX 
.XX !
SetDbStatementForTextXX !
=XX" #
trueXX$ (
;XX( )
samYY 
.YY ,
 SetDbStatementForStoredProcedureYY ,
=YY- .
trueYY/ 3
;YY3 4
}ZZ 
)ZZ 
;ZZ 
x[[ 
.[[ 
AddJaegerExporter[[ 
([[ 
sam[[ 
=>[[ 
{\\ 
sam]] 
.]] 
	AgentHost]] 
=]] 
$str]] #
;]]# $
sam^^ 
.^^ 
	AgentPort^^ 
=^^ 
$num^^ 
;^^ 
}__ 
)__ 
;__ 
x`` 
.`` 
AddZipkinExporter`` 
(`` 
sam`` 
=>`` 
{aa 
sambb 
.bb 
Endpointbb 
=bb 
newbb 
Uribb 
(bb 
$"bb !
$strbb! C
"bbC D
)bbD E
;bbE F
}cc 
)cc 
;cc 
}dd 
)dd 
;dd 
varff 
appff 
=ff 	
builderff
 
.ff 
Buildff 
(ff 
)ff 
;ff 
appgg 
.gg 

UseSwaggergg 
(gg 
)gg 
;gg 
apphh 
.hh 
UseSwaggerUIhh 
(hh 
)hh 
;hh 
appii 
.ii 
UseCorsii 
(ii 
)ii 
;ii 
appjj 
.jj 
UseAuthenticationjj 
(jj 
)jj 
;jj 
appkk 
.kk 
UseAuthorizationkk 
(kk 
)kk 
;kk 
appll 
.ll 
MapControllersll 
(ll 
)ll 
;ll 
appmm 
.mm 
Runmm 
(mm 
)mm 	
;mm	 

voidoo 
ConfigureLogsoo 
(oo 
)oo 
{pp 
varqq 
environmentqq 
=qq 
Environmentqq !
.qq! ""
GetEnvironmentVariableqq" 8
(qq8 9
$strqq9 Q
)qqQ R
;qqR S
varss 
configurationss 
=ss 
newss  
ConfigurationBuilderss 0
(ss0 1
)ss1 2
.tt 	
AddJsonFilett	 
(tt 
$strtt '
,tt' (
optionaltt) 1
:tt1 2
falsett3 8
,tt8 9
reloadOnChangett: H
:ttH I
truettJ N
)ttN O
.uu 	
Builduu	 
(uu 
)uu 
;uu 
Logww 
.ww 
Loggerww 
=ww 
newww 
LoggerConfigurationww (
(ww( )
)ww) *
.xx 	
Enrichxx	 
.xx 
FromLogContextxx 
(xx 
)xx  
.yy 	
Enrichyy	 
.yy  
WithExceptionDetailsyy $
(yy$ %
)yy% &
.zz 	
WriteTozz	 
.zz 
Debugzz 
(zz 
)zz 
.{{ 	
WriteTo{{	 
.{{ 
Console{{ 
({{ 
){{ 
.|| 	
WriteTo||	 
.|| 
Elasticsearch|| 
(|| 
ConfigureELS|| +
(||+ ,
configuration||, 9
,||9 :
environment||; F
)||F G
)||G H
.}} 	
CreateLogger}}	 
(}} 
)}} 
;}} 
}~~ $
ElasticsearchSinkOptionsÄÄ 
ConfigureELS
ÄÄ %
(
ÄÄ% & 
IConfigurationRoot
ÄÄ& 8
configuration
ÄÄ9 F
,
ÄÄF G
string
ÄÄH N
?
ÄÄN O
environment
ÄÄP [
)
ÄÄ[ \
{ÅÅ 
return
ÇÇ 

new
ÇÇ &
ElasticsearchSinkOptions
ÇÇ '
(
ÇÇ' (
new
ÇÇ( +
Uri
ÇÇ, /
(
ÇÇ/ 0
$str
ÇÇ0 G
)
ÇÇG H
)
ÇÇH I
{
ÉÉ "
AutoRegisterTemplate
ÑÑ 
=
ÑÑ 
true
ÑÑ #
,
ÑÑ# $
IndexFormat
ÖÖ 
=
ÖÖ 
$"
ÖÖ 
{
ÖÖ 
Assembly
ÖÖ !
.
ÖÖ! ""
GetExecutingAssembly
ÖÖ" 6
(
ÖÖ6 7
)
ÖÖ7 8
.
ÖÖ8 9
GetName
ÖÖ9 @
(
ÖÖ@ A
)
ÖÖA B
.
ÖÖB C
Name
ÖÖC G
?
ÖÖG H
.
ÖÖH I
ToLower
ÖÖI P
(
ÖÖP Q
)
ÖÖQ R
}
ÖÖR S
$str
ÖÖS T
{
ÖÖT U
environment
ÖÖU `
?
ÖÖ` a
.
ÖÖa b
ToLower
ÖÖb i
(
ÖÖi j
)
ÖÖj k
.
ÖÖk l
Replace
ÖÖl s
(
ÖÖs t
$str
ÖÖt w
,
ÖÖw x
$str
ÖÖx {
)
ÖÖ{ |
}
ÖÖ| }
$str
ÖÖ} ~
{
ÖÖ~ 
DateTimeÖÖ á
.ÖÖá à
UtcNowÖÖà é
:ÖÖé è
$strÖÖè ñ
}ÖÖñ ó
"ÖÖó ò
}
ÜÜ 
;
ÜÜ 
}áá –
QC:\Users\2048766\source\angular-websites\RestApi\RestApi\Services\IUserService.cs
	namespace 	
RestApi
 
. 
Services 
{ 
public 

	interface 
IUserService !
{ 
public 
void 
Add 
( 
User 
user !
)! "
;" #
public 
void 
	DeleteAll 
( 
) 
;  
public		 
void		 

DeleteById		 
(		 
string		 %
id		& (
)		( )
;		) *
public

 
User

 
GetById

 
(

 
string

 "
id

# %
)

% &
;

& '
public 
List 
< 
User 
> 
GetUsers "
(" #
)# $
;$ %
public 
void 
Update 
( 
User 
user  $
)$ %
;% &
} 
} –8
PC:\Users\2048766\source\angular-websites\RestApi\RestApi\Services\UserService.cs
	namespace 	
RestApi
 
. 
Services 
{ 
public 

class 
UserService 
: 
IUserService +
{ 
private 
readonly 
string 
ConnectionString  0
;0 1
public		 
UserService		 
(		 
IConfiguration		 )
configuration		* 7
)		7 8
{

 	
ConnectionString 
= 
configuration ,
[, -
$str- R
]R S
;S T
} 	
public 
void 
Add 
( 
User 
user !
)! "
{ 	
MongoClient 
dbClient  
=! "
new# &
MongoClient' 2
(2 3
ConnectionString3 C
)C D
;D E
dbClient 
. 
GetDatabase  
(  !
$str! '
)' (
.( )
GetCollection) 6
<6 7
User7 ;
>; <
(< =
$str= C
)C D
.D E
	InsertOneE N
(N O
userO S
)S T
;T U
} 	
public 
void 
	DeleteAll 
( 
) 
{ 	
MongoClient 
dbClient  
=! "
new# &
MongoClient' 2
(2 3
ConnectionString3 C
)C D
;D E
dbClient 
. 
GetDatabase  
(  !
$str! '
)' (
.( )
GetCollection) 6
<6 7
User7 ;
>; <
(< =
$str= C
)C D
.D E

DeleteManyE O
(O P
xP Q
=>R T
trueU Y
)Y Z
;Z [
} 	
public 
void 

DeleteById 
( 
string %
id& (
)( )
{ 	
MongoClient 
dbClient  
=! "
new# &
MongoClient' 2
(2 3
ConnectionString3 C
)C D
;D E
var 
filter 
= 
Builders !
<! "
User" &
>& '
.' (
Filter( .
.. /
Eq/ 1
(1 2
$str2 6
,6 7
id8 :
): ;
;; <
dbClient 
. 
GetDatabase  
(  !
$str! '
)' (
.( )
GetCollection) 6
<6 7
User7 ;
>; <
(< =
$str= C
)C D
.D E
	DeleteOneE N
(N O
filterO U
)U V
;V W
} 	
public   
User   
GetById   
(   
string   "
id  # %
)  % &
{!! 	
MongoClient"" 
dbClient""  
=""! "
new""# &
MongoClient""' 2
(""2 3
ConnectionString""3 C
)""C D
;""D E
var## 
user## 
=## 
dbClient## 
.##  
GetDatabase##  +
(##+ ,
$str##, 2
)##2 3
.##3 4
GetCollection##4 A
<##A B
User##B F
>##F G
(##G H
$str##H N
)##N O
.##O P
AsQueryable##P [
(##[ \
)##\ ]
.##] ^
ToList##^ d
(##d e
)##e f
.##f g
FirstOrDefault##g u
(##u v
x##v w
=>##x z
x##{ |
.##| }
Id##} 
==
##Ä Ç
id
##É Ö
)
##Ö Ü
;
##Ü á
if$$ 
($$ 
user$$ 
==$$ 
null$$ 
)$$ 
throw$$ #
new$$$ '
SystemException$$( 7
($$7 8
)$$8 9
;$$9 :
return%% 
user%% 
;%% 
}&& 	
public(( 
List(( 
<(( 
User(( 
>(( 
GetUsers(( "
(((" #
)((# $
{)) 	
MongoClient** 
dbClient**  
=**! "
new**# &
MongoClient**' 2
(**2 3
ConnectionString**3 C
)**C D
;**D E
var++ 
dbList++ 
=++ 
dbClient++ !
.++! "
GetDatabase++" -
(++- .
$str++. 4
)++4 5
.++5 6
GetCollection++6 C
<++C D
User++D H
>++H I
(++I J
$str++J P
)++P Q
.++Q R
AsQueryable++R ]
(++] ^
)++^ _
.++_ `
ToList++` f
(++f g
)++g h
;++h i
return,, 
dbList,, 
;,, 
}-- 	
public// 
void// 
Update// 
(// 
User// 
user//  $
)//$ %
{00 	
MongoClient11 
dbClient11  
=11! "
new11# &
MongoClient11' 2
(112 3
ConnectionString113 C
)11C D
;11D E
var22 
filter22 
=22 
Builders22 !
<22! "
User22" &
>22& '
.22' (
Filter22( .
.22. /
Eq22/ 1
(221 2
$str222 6
,226 7
user228 <
.22< =
Id22= ?
)22? @
;22@ A
var33 
update33 
=33 
Builders33 !
<33! "
User33" &
>33& '
.33' (
Update33( .
.33. /
Set44 
(44 
$str44 
,44  
user44! %
.44% &
	FirstName44& /
)44/ 0
.440 1
Set55 
(55 
$str55 
,55 
user55  $
.55$ %
LastName55% -
)55- .
.55. /
Set66 
(66 
$str66 
,66 
user66 !
.66! "
Email66" '
)66' (
.66( )
Set77 
(77 
$str77 
,77 
user77 #
.77# $
LoginId77$ +
)77+ ,
.77, -
Set88 
(88 
$str88 
,88 
user88  $
.88$ %
Password88% -
)88- .
.88. /
Set99 
(99 
$str99 #
,99# $
user99% )
.99) *
ContactNumber99* 7
)997 8
;998 9
dbClient;; 
.;; 
GetDatabase;;  
(;;  !
$str;;! '
);;' (
.;;( )
GetCollection;;) 6
<;;6 7
User;;7 ;
>;;; <
(;;< =
$str;;= C
);;C D
.;;D E
	UpdateOne;;E N
(;;N O
filter;;O U
,;;U V
update;;W ]
);;] ^
;;;^ _
}<< 	
}== 
}>> 